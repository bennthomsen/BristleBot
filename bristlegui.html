<html>
    <head>
        <meta name="viewport" content="width=device-width, height=device-height">
            <script>
                var wsUri = "ws://192.168.4.1:81/";
                
                function testWebSocket() {
                    connection = new WebSocket(wsUri);
                    connection.onopen = function(evt) {
                        console.log("CONNECTED");
                    };
                    connection.onclose = function(evt) {
                        console.log("DISCONNECTED");
                    };
                    connection.onmessage = function(evt) {
                        console.log('Server: ', evt.data);
                        document.getElementById("RxData").innerHTML = event.data;
                    };
                    connection.onerror = function(evt) {
                        console.log("ERROR: " + evt.data);
                    };
                }
            

            function ledFn() {
                var toSend = "LED";
                connection.send(toSend);
            }
            function resetFn() {
                var toSend = "RESET";
                connection.send(toSend);
                document.getElementById("inputSliderR").value = "0";
                document.getElementById("outputTextR").innerHTML="0";
                document.getElementById("inputSliderL").value = "0";
                document.getElementById("outputTextL").innerHTML="0";
            }

            function mod(){
                var text = document.getElementById('ip').value;
                ipValue = text;
                connection = new WebSocket(ipValue, ['arduino']);
                console.log("IP value changed to:"+ipValue);
            }

            function showValueR(newValue)
            {
                document.getElementById("outputTextR").innerHTML=newValue;
                
                connection.send("x"+newValue);
            }
            
            function showValueL(newValue)
            {
                document.getElementById("outputTextL").innerHTML=newValue;
                
                connection.send("y"+newValue);
            }
window.addEventListener("load", testWebSocket, false);
            </script>
            
    </head>
    <body style="height=100% width=100%">
        Bristle Bot<p></p>
        
        <table id="outside">
            <input type="text"  placeholder="Input the IP of your Websocket server" id="ip" onchange="mod()"> E.g ws://192.168.4.1:81/ </tr>
                
                </table>
        
        <input type="button" onclick="ledFn()">Blink LED	<p><p></p>
            <input type="button" onclick="resetFn()">Stop Motors <p></p>
                
                
                Steer   <input type="range" id= "inputSliderR" min="-128" max="127" value="0" step="1" oninput="showValueR(this.value)" /><span id="outputTextR">0</span>
                <br>
                Power <input type="range" id= "inputSliderL" min="0" max="255" value="0" step="1" oninput="showValueL(this.value)" /><span id="outputTextL">0</span>

                <br><span id="RxData">data</span>
                
    </body>
</html>
